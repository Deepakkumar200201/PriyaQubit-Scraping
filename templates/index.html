{% extends 'base.html' %}

{% block title %}PriyaQubit - Professional Web Scraper Dashboard{% endblock %}

{% block breadcrumb %}
<li class="breadcrumb-item"><a href="{{ url_for('index') }}">Home</a></li>
<li class="breadcrumb-item active" aria-current="page">Dashboard</li>
{% endblock %}

{% block content %}
<!-- Hero Section -->
<div class="card gradient-bg text-white mb-5 border-0">
    <div class="card-body p-5">
        <div class="row align-items-center">
            <div class="col-lg-8">
                <h1 class="display-4 fw-bold mb-3">PriyaQubit Web Scraping</h1>
                <p class="lead mb-4">Extract, analyze, and visualize web data with an intuitive dashboard powered by intelligent scraping technology.</p>
                <div class="d-flex flex-wrap gap-3 mb-2">
                    <a href="#scraping-form" class="btn btn-light btn-lg px-4">
                        <i class="fas fa-code me-2"></i> Start Scraping
                    </a>
                    <a href="{{ url_for('history') }}" class="btn btn-outline-light btn-lg px-4">
                        <i class="fas fa-history me-2"></i> View History
                    </a>
                </div>
                <div class="mt-4">
                    <div class="d-flex align-items-center">
                        <div class="pe-3">
                            <span class="badge status-completed">Intelligent</span>
                        </div>
                        <div class="pe-3">
                            <span class="badge status-completed">Fast</span>
                        </div>
                        <div class="pe-3">
                            <span class="badge status-completed">Professional</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 d-none d-lg-block text-center">
                <div class="p-3 text-center">
                    <i class="fas fa-cube fa-6x text-white-50 mb-3"></i>
                    <div class="position-relative">
                        <i class="fas fa-spider fa-3x position-absolute" style="top: -80px; right: 30px; opacity: 0.7;"></i>
                        <i class="fas fa-database fa-2x position-absolute" style="top: -40px; left: 40px; opacity: 0.6;"></i>
                        <i class="fas fa-chart-line fa-2x position-absolute" style="bottom: -20px; right: 50px; opacity: 0.8;"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Key Features Section -->
<div class="mb-5">
    <div class="row mb-4">
        <div class="col-12">
            <h2 class="text-center mb-1">Advanced Web Scraping Features</h2>
            <p class="text-muted text-center">Powerful tools to extract and process web data efficiently</p>
        </div>
    </div>
    <div class="row g-4">
        <div class="col-md-4">
            <div class="card feature-card h-100 bg-dark">
                <div class="card-body text-center p-4">
                    <div class="feature-icon text-primary">
                        <i class="fas fa-brain"></i>
                    </div>
                    <h3 class="card-title h5 mb-3">Intelligent Selection</h3>
                    <p class="card-text text-muted">Our AI automatically identifies important elements on any webpage, saving you time and effort in manual selection.</p>
                    <div class="mt-3">
                        <span class="badge bg-primary bg-opacity-10 text-primary">Smart Detection</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card feature-card h-100 bg-dark">
                <div class="card-body text-center p-4">
                    <div class="feature-icon text-info">
                        <i class="fas fa-chart-bar"></i>
                    </div>
                    <h3 class="card-title h5 mb-3">Interactive Visualization</h3>
                    <p class="card-text text-muted">Instantly analyze and visualize your scraped data with interactive charts and graphs for deeper insights.</p>
                    <div class="mt-3">
                        <span class="badge bg-info bg-opacity-10 text-info">Real-time Analytics</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card feature-card h-100 bg-dark">
                <div class="card-body text-center p-4">
                    <div class="feature-icon text-success">
                        <i class="fas fa-file-export"></i>
                    </div>
                    <h3 class="card-title h5 mb-3">Versatile Data Export</h3>
                    <p class="card-text text-muted">Export your data in multiple formats including CSV and JSON for seamless integration with your workflow.</p>
                    <div class="mt-3">
                        <span class="badge bg-success bg-opacity-10 text-success">Multiple Formats</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Scraping Form -->
<div class="card card-form mb-5" id="scraping-form">
    <div class="card-header gradient-bg text-white">
        <div class="d-flex align-items-center">
            <i class="fas fa-spider fa-lg me-2"></i>
            <h2 class="h4 mb-0">Web Scraping Console</h2>
        </div>
    </div>
    <div class="card-body p-4">
        <form action="{{ url_for('scrape') }}" method="POST" id="scrape_form">
            <div class="mb-4">
                <label for="url" class="form-label fw-bold">Target URL <span class="text-danger">*</span></label>
                <div class="input-group input-group-lg mb-2">
                    <span class="input-group-text"><i class="fas fa-link"></i></span>
                    <input type="url" class="form-control" id="url" name="url" placeholder="https://example.com" required>
                    <button type="button" class="btn btn-outline-secondary" id="analyze_url">
                        <i class="fas fa-search me-1"></i> Analyze
                    </button>
                </div>
                <div class="form-text">
                    <i class="fas fa-info-circle me-1 text-primary"></i>
                    Enter the complete URL of the webpage you want to scrape (including https://)
                </div>
            </div>
            
            <div class="row mb-4">
                <div class="col-md-4">
                    <label for="selector_type" class="form-label fw-bold">Data Type</label>
                    <select class="form-select form-select-lg" id="selector_type" name="selector_type">
                        <option value="tag">HTML Tags</option>
                        <option value="class">CSS Classes</option>
                        <option value="id">Element IDs</option>
                        <option value="css">CSS Selectors</option>
                        <option value="images">Image Elements</option>
                        <option value="links">Link Elements</option>
                        <option value="robots">Robots.txt Analysis</option>
                        <option value="meta">Meta Information</option>
                    </select>
                    <div class="form-text mt-2">
                        <i class="fas fa-filter me-1 text-info"></i>
                        Choose the type of data you want to extract
                    </div>
                </div>
                <div class="col-md-8">
                    <label for="selector_value" class="form-label fw-bold">Smart Selection</label>
                    <div class="input-group input-group-lg">
                        <span class="input-group-text bg-primary bg-opacity-10"><i class="fas fa-magic text-primary"></i></span>
                        <select class="form-select" id="selector_value" name="selector_value">
                            <option value="" selected>AI recommendations will appear here</option>
                        </select>
                    </div>
                    <div class="form-text mt-2" id="selector_help">
                        <i class="fas fa-robot me-1 text-primary"></i>
                        Our AI analyzes the page structure and recommends the most relevant elements based on your selection.
                    </div>
                </div>
            </div>
            
            <div class="mb-4">
                <label for="session_name" class="form-label fw-bold">Session Name (Optional)</label>
                <div class="input-group">
                    <span class="input-group-text"><i class="fas fa-tag"></i></span>
                    <input type="text" class="form-control" id="session_name" name="session_name" placeholder="My Scraping Project">
                </div>
                <div class="form-text">
                    <i class="fas fa-bookmark me-1 text-success"></i>
                    Name your scraping session for easier reference in your history (defaults to the page title)
                </div>
            </div>
            
            <div class="d-flex flex-column flex-md-row justify-content-between align-items-center gap-3">
                <div>
                    <button type="button" id="preview_selector" class="btn btn-outline-info btn-lg">
                        <i class="fas fa-eye me-2"></i> Preview Results
                    </button>
                </div>
                <div>
                    <button type="submit" class="btn btn-primary btn-lg px-4">
                        <i class="fas fa-code me-2"></i> Start Scraping
                    </button>
                </div>
            </div>
        </form>
    </div>
    <div class="card-footer bg-dark p-3">
        <div class="d-flex align-items-start">
            <div class="me-3 text-info">
                <i class="fas fa-lightbulb fa-lg"></i>
            </div>
            <div class="small text-muted">
                <strong>Pro Tip:</strong> Enter a URL and click "Analyze" to let PriyaQubit AI automatically identify important elements on the webpage. The system scans page structure and suggests the most relevant elements based on content patterns, saving you time and ensuring optimal results.
            </div>
        </div>
    </div>
</div>

<!-- How It Works Section -->
<div class="mb-5">
    <h2 class="text-center mb-4">The PriyaQubit Process</h2>
    <p class="text-center text-muted mb-5">Our intelligent scraping process makes data extraction simple and efficient</p>
    
    <div class="timeline">
        <div class="row g-4">
            <div class="col-md-3">
                <div class="timeline-step text-center">
                    <div class="timeline-icon rounded-circle bg-primary bg-opacity-10 d-inline-flex justify-content-center align-items-center mb-3" style="width: 80px; height: 80px;">
                        <i class="fas fa-globe fa-2x text-primary"></i>
                    </div>
                    <h4 class="h5 mb-3">1. Identify Source</h4>
                    <p class="text-muted">Enter the URL of the website you want to extract data from</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="timeline-step text-center">
                    <div class="timeline-icon rounded-circle bg-info bg-opacity-10 d-inline-flex justify-content-center align-items-center mb-3" style="width: 80px; height: 80px;">
                        <i class="fas fa-robot fa-2x text-info"></i>
                    </div>
                    <h4 class="h5 mb-3">2. AI Analysis</h4>
                    <p class="text-muted">Our intelligent system identifies and recommends the most valuable content elements</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="timeline-step text-center">
                    <div class="timeline-icon rounded-circle bg-success bg-opacity-10 d-inline-flex justify-content-center align-items-center mb-3" style="width: 80px; height: 80px;">
                        <i class="fas fa-magic fa-2x text-success"></i>
                    </div>
                    <h4 class="h5 mb-3">3. Data Extraction</h4>
                    <p class="text-muted">The system efficiently extracts and processes your selected data elements</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="timeline-step text-center">
                    <div class="timeline-icon rounded-circle bg-warning bg-opacity-10 d-inline-flex justify-content-center align-items-center mb-3" style="width: 80px; height: 80px;">
                        <i class="fas fa-chart-pie fa-2x text-warning"></i>
                    </div>
                    <h4 class="h5 mb-3">4. Visualization</h4>
                    <p class="text-muted">View, analyze, and export your data with comprehensive visualization tools</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Advanced Features -->
<div class="card bg-dark mb-5">
    <div class="card-body p-4">
        <div class="row">
            <div class="col-lg-6 mb-4 mb-lg-0">
                <h3 class="h4 mb-4">Advanced Capabilities</h3>
                
                <div class="d-flex align-items-start mb-4">
                    <div class="me-3 text-primary">
                        <i class="fas fa-image fa-lg"></i>
                    </div>
                    <div>
                        <h4 class="h6 mb-2">Image Extraction</h4>
                        <p class="text-muted small mb-0">Automatically detect and categorize images from websites with intelligent filtering for product images, banners, and more.</p>
                    </div>
                </div>
                
                <div class="d-flex align-items-start mb-4">
                    <div class="me-3 text-info">
                        <i class="fas fa-link fa-lg"></i>
                    </div>
                    <div>
                        <h4 class="h6 mb-2">Smart Link Analysis</h4>
                        <p class="text-muted small mb-0">Identify and categorize internal and external links, navigation elements, and other important hyperlinks on any webpage.</p>
                    </div>
                </div>
                
                <div class="d-flex align-items-start mb-4">
                    <div class="me-3 text-success">
                        <i class="fas fa-robot fa-lg"></i>
                    </div>
                    <div>
                        <h4 class="h6 mb-2">Robots.txt Analyzer</h4>
                        <p class="text-muted small mb-0">Automatically parse and analyze robots.txt files to determine crawlability rules and site structure.</p>
                    </div>
                </div>
                
                <div class="d-flex align-items-start">
                    <div class="me-3 text-warning">
                        <i class="fas fa-tags fa-lg"></i>
                    </div>
                    <div>
                        <h4 class="h6 mb-2">Meta Information Extraction</h4>
                        <p class="text-muted small mb-0">Extract metadata, SEO elements, Open Graph tags, and other hidden information from web pages.</p>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-6">
                <div class="card bg-black h-100">
                    <div class="card-header bg-primary bg-opacity-10 text-primary">
                        <i class="fas fa-code me-2"></i> Sample Extraction
                    </div>
                    <div class="card-body p-3">
                        <div class="mb-3">
                            <span class="element-tag mb-2">Selector: .product-item</span>
                            <div class="bg-dark p-3 rounded" style="font-family: monospace; font-size: 0.85rem;">
                                <div>&lt;div class="product-item"&gt;</div>
                                <div>&nbsp;&nbsp;&lt;h3&gt;Product Title&lt;/h3&gt;</div>
                                <div>&nbsp;&nbsp;&lt;div class="price"&gt;$99.99&lt;/div&gt;</div>
                                <div>&nbsp;&nbsp;&lt;div class="rating"&gt;★★★★☆&lt;/div&gt;</div>
                                <div>&lt;/div&gt;</div>
                            </div>
                        </div>
                        <p class="text-muted small">
                            PriyaQubit intelligently identifies and extracts structured data from websites, allowing you to easily capture product information, articles, listings, and more without writing complex selectors.
                        </p>
                        <div class="d-flex justify-content-end">
                            <a href="{{ url_for('help_page') }}" class="btn btn-sm btn-outline-info">Learn More</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Recent Sessions Section -->
{% if recent_sessions %}
<div class="mb-5">
    <h3 class="mb-4">Your Recent Scraping Sessions</h3>
    <div class="row">
        {% for session in recent_sessions[:3] %}
        <div class="col-lg-4 mb-4">
            <div class="card bg-dark h-100">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-code me-2 text-primary"></i>
                        <h5 class="mb-0 small">{{ session.name }}</h5>
                    </div>
                    <span class="badge status-{{ session.status }}">{{ session.status }}</span>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <a href="{{ session.url }}" target="_blank" class="text-truncate d-block text-decoration-none">
                            <i class="fas fa-external-link-alt me-1"></i> {{ session.url }}
                        </a>
                    </div>
                    <div class="d-flex justify-content-between">
                        <div class="small text-muted">
                            <i class="far fa-clock me-1"></i> {{ session.timestamp.strftime('%Y-%m-%d') }}
                        </div>
                        <div class="small">
                            <span class="element-tag">{{ session.selector_type }}: {{ session.selector_value }}</span>
                        </div>
                    </div>
                </div>
                <div class="card-footer">
                    <a href="{{ url_for('visualization', session_id=session.id) }}" class="btn btn-sm btn-primary w-100">
                        <i class="fas fa-chart-bar me-1"></i> View Results
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    <div class="text-center mt-3">
        <a href="{{ url_for('history') }}" class="btn btn-outline-light">
            <i class="fas fa-history me-2"></i> View All Sessions
        </a>
    </div>
</div>
{% endif %}

<!-- Call to Action -->
<div class="card text-center border-0 mb-4">
    <div class="card-body gradient-bg text-white p-5 rounded">
        <h2 class="mb-3">Ready to extract web data?</h2>
        <p class="lead mb-4">Start scraping with PriyaQubit's intelligent web extraction technology</p>
        <a href="#scraping-form" class="btn btn-light btn-lg px-5">
            <i class="fas fa-rocket me-2"></i> Get Started Now
        </a>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Add animation for page loading
    document.addEventListener('DOMContentLoaded', function() {
        // Add smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    window.scrollTo({
                        top: target.offsetTop - 80,
                        behavior: 'smooth'
                    });
                }
            });
        });
        
        // Add analyze button functionality
        const analyzeButton = document.getElementById('analyze_url');
        if (analyzeButton) {
            analyzeButton.addEventListener('click', function() {
                const urlInput = document.getElementById('url');
                if (urlInput && urlInput.value) {
                    // Call the fetchSelectorOptions function from main.js
                    fetchSelectorOptions(urlInput.value);
                } else {
                    showAlert('Please enter a valid URL first', 'warning');
                }
            });
        }
    });
</script>
{% endblock %}
